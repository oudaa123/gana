<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>نظام كراسة اليومية - الكاشير</title>
<style>
  :root {
    --accent:#6ed0ff;
    --btn:#ff9ad1;
    --done:#d8d8d8;
    --pending:#fff7a5;
    --warning:#ffcccc;
    --active:#4CAF50;
    --primary: #2196F3;
    --secondary: #FF9800;
    --success: #4CAF50;
    --danger: #f44336;
    --light: #f8f9fa;
    --dark: #343a40;
  }

  * {
    box-sizing: border-box;
  }

  body {
    font-family: Tahoma, Arial;
    background: linear-gradient(135deg, #e8f8ff 0%, #f0f8ff 100%);
    margin: 0;
    padding: 10px;
    color: #333;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    background: white;
    border-radius: 15px;
    box-shadow: 0 0 20px rgba(0,0,0,0.1);
    padding: 20px;
  }

  h2 {
    text-align: center;
    margin-bottom: 5px;
    color: #004466;
    font-size: 28px;
  }

  #datetime {
    text-align: center;
    font-size: 14px;
    color: #333;
    margin-bottom: 5px;
  }

  #currentDateDisplay {
    text-align: center;
    font-size: 16px;
    font-weight: bold;
    color: #004466;
    margin-bottom: 10px;
    padding: 5px;
    background-color: #d8f0ff;
    border-radius: 5px;
  }

  #topBar {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 10px;
    flex-wrap: wrap;
  }

  .cashier-section {
    display: grid;
    grid-template-columns: 1fr;
    gap: 20px;
    margin-bottom: 20px;
  }

  .input-panel {
    background: #f8fdff;
    border-radius: 10px;
    padding: 15px;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
  }

  .input-group {
    margin-bottom: 15px;
  }

  .input-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    color: #004466;
  }

  input, button, select {
    padding: 12px;
    border-radius: 8px;
    border: 1px solid #ccc;
    font-size: 16px;
    width: 100%;
  }

  input:focus, select:focus {
    outline: none;
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(33, 150, 243, 0.2);
  }

  button {
    background: var(--btn);
    color: #000;
    cursor: pointer;
    font-weight: bold;
    transition: 0.2s;
    border: none;
  }

  button:hover {
    background: #ff7ec5;
    transform: translateY(-2px);
  }

  .btn-primary {
    background: var(--primary);
    color: white;
  }

  .btn-success {
    background: var(--success);
    color: white;
  }

  .btn-danger {
    background: var(--danger);
    color: white;
  }

  .btn-secondary {
    background: var(--secondary);
    color: white;
  }

  .btn-group {
    display: flex;
    gap: 10px;
  }

  .btn-group button {
    flex: 1;
  }

  .quantity-controls {
    display: flex;
    gap: 5px;
    margin-top: 10px;
  }

  .quantity-controls button {
    flex: 0 0 50px;
  }

  .quantity-controls input {
    flex: 1;
    text-align: center;
  }

  .suggestions {
    position: absolute;
    background: white;
    border: 1px solid #ccc;
    border-radius: 5px;
    width: calc(100% - 24px);
    max-height: 200px;
    overflow-y: auto;
    z-index: 100;
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .suggestion-item {
    padding: 10px;
    cursor: pointer;
    border-bottom: 1px solid #eee;
  }

  .suggestion-item:hover {
    background: #f0f8ff;
  }

  .suggestion-item:last-child {
    border-bottom: none;
  }

  .input-with-suggestions {
    position: relative;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.05);
  }

  th, td {
    border: 1px solid #ccc;
    padding: 10px;
    text-align: center;
  }

  th {
    background: var(--accent);
    font-weight: bold;
  }

  tr.done td {
    text-decoration: line-through;
    color: red;
    background: var(--done);
  }

  tr.pending td {
    background: var(--pending);
  }

  .day-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
    margin-top: 10px;
    justify-content: center;
  }

  .day-buttons button {
    background: var(--accent);
    border: none;
    flex: 0 1 auto;
    width: auto;
    padding: 8px 15px;
  }

  .day-buttons button.active {
    background: var(--active);
    color: white;
    font-weight: bold;
  }

  .warning {
    background-color: var(--warning) !important;
  }

  .hidden {
    display: none;
  }

  .product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 10px;
    margin-top: 15px;
    max-height: 200px;
    overflow-y: auto;
    padding: 10px;
    border: 1px solid #eee;
    border-radius: 8px;
    background: #f9f9f9;
  }

  .product-item {
    background: white;
    border: 1px solid #ddd;
    border-radius: 8px;
    padding: 10px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
  }

  .product-item:hover {
    background: #f0f8ff;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  }

  .product-item.selected {
    background: var(--accent);
    border-color: var(--primary);
  }

  @media (max-width:600px){
    .cashier-section {
      grid-template-columns: 1fr;
    }
    
    .btn-group {
      flex-direction: column;
    }
    
    .product-grid {
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    }
  }
</style>
</head>
<body>

<div class="container">
  <h2>🧾 نظام كراسة اليومية - الكاشير</h2>
  <div id="datetime"></div>
  <div id="currentDateDisplay"></div>

  <div id="topBar">
    <button onclick="confirmDeleteAll()" class="btn-danger">🗑️ حذف جميع البيانات</button>
    <button onclick="confirmDeleteWeek()" class="btn-secondary">🧹 حذف بيانات الأسبوع</button>
    <button onclick="showProductManager()" class="btn-primary">📦 إدارة المنتجات</button>
  </div>

  <div class="cashier-section">
    <div class="input-panel">
      <h3>إدخال البيانات</h3>
      
      <div class="input-group">
        <label for="person">الاسم</label>
        <input type="text" id="person" placeholder="اسم العميل">
      </div>
      
      <div class="input-group">
        <label for="item">الصنف</label>
        <div class="input-with-suggestions">
          <input type="text" id="item" placeholder="ابحث عن المنتج أو أدخل منتج جديد">
          <div id="itemSuggestions" class="suggestions hidden"></div>
        </div>
      </div>
      
      <div class="input-group">
        <label>المنتجات المتاحة</label>
        <div class="product-grid" id="productGrid"></div>
      </div>
      
      <div class="input-group">
        <label for="qty">الكمية</label>
        <div class="quantity-controls">
          <button type="button" onclick="decreaseQuantity()">-</button>
          <input type="number" id="qty" value="1" min="1">
          <button type="button" onclick="increaseQuantity()">+</button>
        </div>
      </div>
      
      <div class="input-group">
        <label for="price">السعر</label>
        <input type="number" id="price" placeholder="السعر (اختياري)">
      </div>
      
      <div class="input-group">
        <label for="receiver">المستلم</label>
        <input type="text" id="receiver" placeholder="المستلم (يتعبأ تلقائياً)">
      </div>
      
      <div class="btn-group">
        <button id="addBtn" class="btn-success">➕ إضافة</button>
      </div>
    </div>
  </div>

  <div class="day-buttons" id="dayButtons"></div>

  <table>
    <thead>
      <tr>
        <th>الاسم</th>
        <th>الصنف</th>
        <th>الكمية</th>
        <th>السعر</th>
        <th>المستلم</th>
        <th>الحالة</th>
        <th>الإجراءات</th>
      </tr>
    </thead>
    <tbody id="tableBody"></tbody>
  </table>
</div>

<!-- نافذة إدارة المنتجات -->
<div id="productManager" class="hidden">
  <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); display: flex; justify-content: center; align-items: center; z-index: 1000;">
    <div style="background: white; padding: 20px; border-radius: 10px; width: 90%; max-width: 600px; max-height: 80vh; overflow-y: auto;">
      <h3>📦 إدارة المنتجات</h3>
      <div class="input-group">
        <label for="newProduct">إضافة منتج جديد</label>
        <div style="display: flex; gap: 10px;">
          <input type="text" id="newProduct" placeholder="اسم المنتج الجديد">
          <button onclick="addNewProduct()" class="btn-success">إضافة</button>
        </div>
      </div>
      
      <h4>المنتجات الحالية</h4>
      <div id="productList" style="max-height: 300px; overflow-y: auto; margin-top: 10px;"></div>
      
      <div style="margin-top: 20px; text-align: center;">
        <button onclick="hideProductManager()" class="btn-primary">إغلاق</button>
      </div>
    </div>
  </div>
</div>

<script>
// البيانات الأساسية
let dailyRecords = JSON.parse(localStorage.getItem("dailyRecords") || "{}");
let currentDisplayDate = getTodayDate();
let lastKnownDate = getTodayDate();
let productList = JSON.parse(localStorage.getItem("productList") || "[]");

// تهيئة قائمة المنتجات إذا كانت فارغة
if (productList.length === 0) {
  productList = [
    "جراب الماس", "جراب اسكتش", "جراب دبوس", "جراب كياه وش وظهر", 
    "جراب جلد مصري", "جراب واير ليس عدسه", "جراب قطيفه", "جراب سيلكون بارز", 
    "جراب 4k", "جراب بامب مربعات", "جراب جلد الك", "جراب جلد شركات", 
    "جراب تاب مدارس", "جراب ليزر", "جراب بامب مصرب", "جراب عدسه اشكال", 
    "جراب بامب حريمي", "جراب ليزر كلاسيك", "اسكرين الترا", "اسكرين اتش دي", 
    "اسكرين اوجي اوog", "اسكرينه غزاله", "اسكرينه فاميه", "اسكرينه تاب مدارس", 
    "صب ٦٦٨", "صب ١١٢", "صب ١١٣", "صب ١٢٢", "صب١٢٥", "صب v16", 
    "صب d36", "صب jpal او ريلمي صغير", "صب ٢٣٠٤", "صب ١٨٨١", "صب ١٠٢٣", 
    "صب عربيه", "صب بازوكا فروا", "صب فرده واحده", "صب بازوكا فرعوني", 
    "صب ٤ بوصه", "صب ٥ بوصه", "صب ٦ بوصه"
  ];
  saveProductList();
}

// الحصول على تاريخ اليوم بصيغة YYYY-MM-DD (التوقيت المحلي)
function getTodayDate() {
  const now = new Date();
  const year = now.getFullYear();
  const month = String(now.getMonth() + 1).padStart(2, '0');
  const day = String(now.getDate()).padStart(2, '0');
  return `${year}-${month}-${day}`;
}

// تحويل تاريخ من صيغة YYYY-MM-DD إلى تاريخ عربي
function formatArabicDate(dateString) {
  const date = new Date(dateString + 'T12:00:00');
  const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
  return date.toLocaleDateString('ar-EG', options);
}

// حساب الفرق بين تاريخين بالأيام
function getDaysDifference(date1, date2) {
  const oneDay = 24 * 60 * 60 * 1000;
  const firstDate = new Date(date1);
  const secondDate = new Date(date2);
  const diffDays = Math.round(Math.abs((firstDate - secondDate) / oneDay));
  return diffDays;
}

// التحقق من تغيير اليوم وتحديث البيانات تلقائياً
function checkDateChange() {
  const today = getTodayDate();
  
  // إذا تغير اليوم ونحن نعرض اليوم الحالي
  if (today !== lastKnownDate && currentDisplayDate === lastKnownDate) {
    console.log('تم تغيير اليوم من', lastKnownDate, 'إلى', today);
    lastKnownDate = today;
    currentDisplayDate = today; // تحديث العرض لليوم الجديد
    
    // تحديث الواجهة
    renderDayButtons();
    renderTable(today);
  }
}

// 🕒 تحديث التاريخ والساعة والتحقق من تغيير اليوم
function updateDateTime() {
  const now = new Date();
  const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
  const dateStr = now.toLocaleDateString('ar-EG', options);
  const timeStr = now.toLocaleTimeString('ar-EG');
  document.getElementById("datetime").textContent = `🕒 ${dateStr} - ${timeStr}`;
  
  // التحقق من تغيير اليوم
  checkDateChange();
  
  // تحديث العرض
  updateCurrentDateDisplay();
}

// تحديث عرض التاريخ الحالي للبيانات المعروضة
function updateCurrentDateDisplay() {
  const dateStr = formatArabicDate(currentDisplayDate);
  
  let displayText = `📅 البيانات المعروضة ليوم: ${dateStr}`;
  
  // إضافة زر للعودة لليوم الحالي فقط إذا كنا نعرض يوم آخر
  if (currentDisplayDate !== getTodayDate()) {
    displayText += ` <button onclick="showToday()" style="margin-right:10px; padding:3px 8px; font-size:12px;">العودة لليوم الحالي</button>`;
  }
  
  document.getElementById("currentDateDisplay").innerHTML = displayText;
}

// عرض بيانات اليوم الحالي (عند الطلب فقط)
function showToday() {
  currentDisplayDate = getTodayDate();
  updateCurrentDateDisplay();
  renderDayButtons();
  renderTable(currentDisplayDate);
}

setInterval(updateDateTime, 1000);
updateDateTime();

// التحكم في الكمية
function increaseQuantity() {
  const qtyInput = document.getElementById("qty");
  qtyInput.value = parseInt(qtyInput.value) + 1;
}

function decreaseQuantity() {
  const qtyInput = document.getElementById("qty");
  if (parseInt(qtyInput.value) > 1) {
    qtyInput.value = parseInt(qtyInput.value) - 1;
  }
}

// البحث التلقائي للمنتجات
document.getElementById("item").addEventListener("input", function() {
  const query = this.value.trim();
  const suggestions = document.getElementById("itemSuggestions");
  
  if (query.length === 0) {
    suggestions.classList.add("hidden");
    return;
  }
  
  const filteredProducts = productList.filter(product => 
    product.toLowerCase().includes(query.toLowerCase())
  );
  
  suggestions.innerHTML = "";
  
  if (filteredProducts.length > 0) {
    filteredProducts.forEach(product => {
      const div = document.createElement("div");
      div.className = "suggestion-item";
      div.textContent = product;
      div.onclick = function() {
        document.getElementById("item").value = product;
        suggestions.classList.add("hidden");
        document.getElementById("price").focus();
        
        // إضافة تأثير التحديد
        document.querySelectorAll(".product-item").forEach(item => {
          item.classList.remove("selected");
        });
      };
      suggestions.appendChild(div);
    });
    suggestions.classList.remove("hidden");
  } else {
    suggestions.classList.add("hidden");
  }
});

// إغلاق الاقتراحات عند النقر خارجها
document.addEventListener("click", function(e) {
  if (!e.target.closest(".input-with-suggestions")) {
    document.getElementById("itemSuggestions").classList.add("hidden");
  }
});

// عرض شبكة المنتجات
function renderProductGrid() {
  const productGrid = document.getElementById("productGrid");
  productGrid.innerHTML = "";
  
  productList.forEach(product => {
    const productItem = document.createElement("div");
    productItem.className = "product-item";
    productItem.textContent = product;
    productItem.onclick = function() {
      document.getElementById("item").value = product;
      document.getElementById("price").focus();
      
      // إضافة تأثير التحديد
      document.querySelectorAll(".product-item").forEach(item => {
        item.classList.remove("selected");
      });
      this.classList.add("selected");
    };
    productGrid.appendChild(productItem);
  });
}

// 🧭 عرض أزرار الأيام
function renderDayButtons() {
  const dayButtons = document.getElementById("dayButtons");
  dayButtons.innerHTML = "";
  
  const today = getTodayDate();
  
  // إضافة زر اليوم الحالي أولاً
  const todayBtn = document.createElement("button");
  todayBtn.textContent = "اليوم الحالي";
  todayBtn.onclick = () => {
    currentDisplayDate = today;
    renderTable(today);
    updateCurrentDateDisplay();
    renderDayButtons();
  };
  if (currentDisplayDate === today) {
    todayBtn.classList.add("active");
  }
  dayButtons.appendChild(todayBtn);
  
  // عرض أزرار الأيام الأخرى
  Object.keys(dailyRecords)
    .sort()
    .reverse()
    .forEach(date => {
      if (date !== today) {
        const btn = document.createElement("button");
        const displayDate = formatArabicDate(date);
        btn.textContent = displayDate.split('، ')[1];
        btn.title = displayDate;
        
        btn.onclick = () => {
          currentDisplayDate = date;
          renderTable(date);
          updateCurrentDateDisplay();
          renderDayButtons();
        };
        
        if (date === currentDisplayDate) {
          btn.classList.add("active");
        }
        
        dayButtons.appendChild(btn);
      }
    });
}

// 📋 عرض جدول اليوم المحدد
function renderTable(date) {
  currentDisplayDate = date;
  const table = document.getElementById("tableBody");
  table.innerHTML = "";
  const records = dailyRecords[date] || [];
  
  if (records.length === 0) {
    const tr = document.createElement("tr");
    tr.innerHTML = `<td colspan="7" style="text-align:center; padding:20px;">لا توجد بيانات لهذا اليوم</td>`;
    table.appendChild(tr);
  } else {
    records.forEach((r, i) => {
      const tr = document.createElement("tr");
      tr.classList.add(r.returned ? "done" : "pending");
      tr.innerHTML = `
        <td>${r.person}</td>
        <td>${r.item}</td>
        <td>${r.qty || ""}</td>
        <td>${r.price ? r.price + " جنيه" : ""}</td>
        <td>${r.receiver}</td>
        <td>${r.returned ? "✅ تم السداد" : "❌ لم يسدد"}</td>
        <td>
          <button onclick="toggleReturn('${date}',${i})" class="${r.returned ? 'btn-secondary' : 'btn-success'}" style="padding: 5px 10px; font-size: 14px;">
            ${r.returned ? "تراجع" : "تم السداد"}
          </button>
          <button onclick="deleteRecord('${date}',${i})" class="btn-danger" style="padding: 5px 10px; font-size: 14px;">حذف</button>
        </td>
      `;
      table.appendChild(tr);
    });
  }
  
  updateCurrentDateDisplay();
}

// 🔁 تبديل حالة الإرجاع
function toggleReturn(date, index) {
  const record = dailyRecords[date][index];
  if (!record.returned) {
    record.returned = true;
  } else {
    if (confirm(`هل أنت متأكد أن "${record.person}" لم يسدد؟`)) {
      const pass = prompt("من فضلك أدخل كلمة السر:");
      if (pass === "888") record.returned = false;
      else return alert("كلمة السر غير صحيحة!");
    }
  }
  saveData();
  renderTable(currentDisplayDate);
}

// حذف سجل (يتطلب كلمة سر)
function deleteRecord(date, index) {
  const pass = prompt("من فضلك أدخل كلمة السر للحذف:");
  if (pass !== "888") {
    return alert("كلمة السر غير صحيحة!");
  }
  
  if (confirm("هل أنت متأكد من حذف هذا السجل؟")) {
    dailyRecords[date].splice(index, 1);
    if (dailyRecords[date].length === 0) {
      delete dailyRecords[date];
    }
    saveData();
    renderTable(currentDisplayDate);
  }
}

// 💾 حفظ البيانات
function saveData() {
  localStorage.setItem("dailyRecords", JSON.stringify(dailyRecords));
  renderDayButtons();
}

// حفظ قائمة المنتجات
function saveProductList() {
  localStorage.setItem("productList", JSON.stringify(productList));
  renderProductGrid();
}

// ➕ إضافة بيانات جديدة
document.getElementById("addBtn").onclick = () => {
  const person = document.getElementById("person").value.trim();
  const item = document.getElementById("item").value.trim();
  const qty = document.getElementById("qty").value.trim();
  const price = document.getElementById("price").value.trim();
  let receiver = document.getElementById("receiver").value.trim();

  if (!person || !item) return alert("يرجى إدخال الاسم والصنف على الأقل");
  if (!receiver) receiver = person;

  // إضافة المنتج الجديد إلى القائمة إذا لم يكن موجوداً
  if (!productList.includes(item)) {
    productList.push(item);
    saveProductList();
  }

  // إضافة البيانات ليوم اليوم الحالي دائماً
  const today = getTodayDate();
  if (!dailyRecords[today]) dailyRecords[today] = [];
  dailyRecords[today].push({ person, item, qty, price, receiver, returned: false });
  saveData();
  
  // إذا كنا نعرض بيانات اليوم الحالي، قم بتحديث الجدول
  if (currentDisplayDate === today) {
    renderTable(today);
  } else {
    // إذا كنا نعرض يوم آخر، قم بتحديث الأزرار فقط
    renderDayButtons();
  }
  
  // مسح الحقول بعد الإضافة
  document.getElementById("person").value = "";
  document.getElementById("item").value = "";
  document.getElementById("qty").value = "1";
  document.getElementById("price").value = "";
  document.getElementById("receiver").value = "";
  
  // إزالة التحديد من المنتجات
  document.querySelectorAll(".product-item").forEach(item => {
    item.classList.remove("selected");
  });
  
  document.getElementById("person").focus();
};

// 🧹 حذف بيانات الأسبوع بباسورد
function confirmDeleteWeek() {
  if (confirm("هل أنت متأكد من حذف بيانات الأسبوع؟ سيتم حذف جميع البيانات الأقدم من 7 أيام.")) {
    const pass = prompt("من فضلك أدخل كلمة السر:");
    if (pass === "888") {
      const today = getTodayDate();
      let deletedCount = 0;
      
      const dates = Object.keys(dailyRecords);
      
      dates.forEach(date => {
        const daysDifference = getDaysDifference(today, date);
        if (daysDifference > 7) {
          delete dailyRecords[date];
          deletedCount++;
        }
      });
      
      saveData();
      
      if (deletedCount > 0) {
        alert(`تم حذف ${deletedCount} يوم من البيانات القديمة بنجاح ✅`);
      } else {
        alert("لا توجد بيانات أقدم من 7 أيام لحذفها");
      }
      
      renderTable(currentDisplayDate);
    } else {
      alert("كلمة السر غير صحيحة!");
    }
  }
}

// 🗑️ حذف جميع البيانات
function confirmDeleteAll() {
  if (confirm("هل أنت متأكد من حذف جميع البيانات؟")) {
    const hasPending = Object.values(dailyRecords).some(records => 
      records.some(record => !record.returned)
    );
    
    if (hasPending) {
      const confirmDelete = confirm("⚠️ تحذير: هناك أشخاص لم يسددوا بعد. هل تريد المتابعة مع حذف جميع البيانات؟");
      if (!confirmDelete) return;
    }
    
    const pass = prompt("من فضلك أدخل كلمة السر:");
    if (pass === "888") {
      dailyRecords = {};
      saveData();
      alert("تم حذف جميع البيانات بنجاح ✅");
      renderTable(currentDisplayDate);
    } else {
      alert("كلمة السر غير صحيحة!");
    }
  }
}

// إدارة المنتجات
function showProductManager() {
  document.getElementById("productManager").classList.remove("hidden");
  renderProductList();
}

function hideProductManager() {
  document.getElementById("productManager").classList.add("hidden");
}

function renderProductList() {
  const productListElement = document.getElementById("productList");
  productListElement.innerHTML = "";
  
  if (productList.length === 0) {
    productListElement.innerHTML = "<p>لا توجد منتجات مضافة</p>";
    return;
  }
  
  productList.forEach((product, index) => {
    const productItem = document.createElement("div");
    productItem.style.display = "flex";
    productItem.style.justifyContent = "space-between";
    productItem.style.alignItems = "center";
    productItem.style.padding = "8px";
    productItem.style.borderBottom = "1px solid #eee";
    
    productItem.innerHTML = `
      <span>${product}</span>
      <button onclick="removeProduct(${index})" class="btn-danger" style="padding: 5px 10px; font-size: 12px;">حذف</button>
    `;
    
    productListElement.appendChild(productItem);
  });
}

function addNewProduct() {
  const newProductInput = document.getElementById("newProduct");
  const productName = newProductInput.value.trim();
  
  if (!productName) {
    alert("يرجى إدخال اسم المنتج");
    return;
  }
  
  if (productList.includes(productName)) {
    alert("هذا المنتج موجود بالفعل");
    return;
  }
  
  productList.push(productName);
  saveProductList();
  newProductInput.value = "";
  renderProductList();
  renderProductGrid();
}

function removeProduct(index) {
  if (confirm(`هل أنت متأكد من حذف "${productList[index]}"؟`)) {
    productList.splice(index, 1);
    saveProductList();
    renderProductList();
    renderProductGrid();
  }
}

// 🟢 تحميل البيانات الافتراضية
renderDayButtons();
renderTable(currentDisplayDate);
renderProductGrid();
</script>

</body>
</html>
